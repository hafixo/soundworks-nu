<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Nü</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/override.css" rel="stylesheet">
    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">

    <!-- Custom CSS -->
    <style>
    body {
        padding-top: 70px;
        /* Required padding for .navbar-fixed-top. Remove if using .navbar-static-top. Change if height of navigation changes. */
    }
    </style>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            
            <!-- github ribbon -->
            <a href="https://github.com/ircam-cosima/soundworks-nu"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>

            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#head"><font color="red">Nü</font> Soundworks</a>
            </div>
            
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li> <a href="#how-it-works">How it works</a> </li>
                    <li> <a href="#getting-started">Getting started</a> </li>
                    <li> <a href="#start-design">Start designing</a> </li>
                    <li> <a href="#deploy">Deployment</a> </li>
                    <li> <a href="#create-module">Create module</a> </li>
                    <li> <a href="#faq">FAQ</a> </li>
                    <li> <a href="#about">About</a> </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Content -->
    <div class="container">

        <div class="row" id="head">
            <div class="col-lg-12 text-left">
                <h1><font color="red">Nü</font> Soundworks</h1>
                <p class="lead">Max/MSP leash on the WebAudio API: spectators devices as distributed speakers and sensors during live performances.</p>
            </div>
             <div class="col-lg-12 text-justify">
                <p>
                    The objective of the Nü framework, based on <a href="https://github.com/collective-soundworks/soundworks/">Soundworks</a>, is to give composers control over the speakers of spectators smartphones during a performance. Connecting their devices to a web page broadcasted by the performer's laptop, spectators become part of the composition: from simple sound sources to active musicians. The performer can then control the behaviors of "Nü modules" via a Max/MSP based interface: modular units (distributed room reverb, granular synthesis, etc.) designed for live composition. Nü has been developed as part of the <a href="http://cosima.ircam.fr/">CoSiMa Project</a>.
                </p>
            </div>

            <div class="col-lg-10 col-lg-offset-1 text-center">
                <div class="embed-responsive embed-responsive-16by9">
                  <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/LCjLwF-msVM" allowfullscreen></iframe>
                </div>
            </div>

        </div>

        <div class="row" id="how-it-works">
            <div class="col-lg-12 text-justify">
                <h1>How it works</h1>
                <p>Nü's objective is to support the design of web-audio install (see video above), where the behavior of each client (device on the floor) is defined from Max. See it as a <a href="https://github.com/Cycling74/miraweb">MiraWeb</a> where the sound and processing actually happens on the connected devices.</p>

                <h4>Over-simplified concept:</h4>
                <p>Connect your laptop and a bunch of smartphones on the same WiFi network. On said laptop, launch the Nü server (see install section) and connect the smartphones to the server. Open a new Max patch and instantiate a nu object. Open the object help, randomly click around: sound should start coming out of the smartphones. Repeat.</p>

                <h4>The real thing:</h4>
                <p>
                    A Nü session involves at least 3 components: a server, a client, and a Max patch. The server (a <a href="https://nodejs.org/en/">NodeJS server</a> if you feel like digging) runs on a laptop, the Max patch as well (can even be the same), and the client on a smartphone connected to the web page the server serves. All three components thus need to be connected to the same network (WiFi, cellular, etc.) for them to address each other. The smartphone connected to the server becomes a client: displaying a welcome screen, it stands ready for Max's instructions (relayed by the server). 
                    <br> <br>
                    These instructions are issues via OSC from a Max abstraction, referred to as a <i>Nü module</i>. Actually, a module designs a triplet [Max-abstraction / Server Class / Client Class]: messages from the abstraction are sent to the server, and re-directed to the concerned clients. Each module is designed to do one thing (and eventually do it right), much like Max's objects (sfplay, loadbang, gate, etc.). On the server and client sides, the messages sent by the Max abstraction are interpreted, most of the time triggering a dedicated method. The figure below details the architecture of a Nü session and the intra-module-inter-context communication concept. 
                </p>
            </div>
            <div class="col-lg-10 col-lg-offset-1 text-center">
                <h4>Architecture of the Nü framework<h4>
                <img class="img-responsive" src="img/nu_architecture.png">                
            </div>

            <div class="col-lg-12 text-justify">
                <p>
                    Based on these modules, one can design a web-based performance without learning JavaScript / HTML / CSS. While a module on its own is limited to a unique feature, they can be combined to do any kind of passive or participative audio-visual rendering on the connected smartphones. The framework has also been designed to simplify the creation of new modules, if ever you feel it's missing a feature.
                </p>

            </div>


        </div>  
        
        <div class="row" id="getting-started">
            <div class="col-lg-12 text-justify">
                <h1>Getting started</h1>
                <p>
                    First, you need to install <a href="https://cycling74.com/">Max</a>. Then, download the <a href="https://github.com/ircam-cosima/soundworks-nu/archive/v1.0.zip">latest release of the Nü framework</a>. Run the ./node/_install_&lt;name-of-your-architecture&gt; file in a terminal. Example with OSX:
                </p>
                <pre> 
                    # (adapt release number below) <br>
                    cd ~/Downloads/soundworks-nu-1.0 <br>
                    ./node/_install_macos.sh
                </pre>
                <p>
                    which should result in a (large) bunch of lines ending with:
                </p>
                <pre> 
                    ## installation complete ##
                </pre>                                
                <p>
                    You then need to start the NodeJS server: from the ./node folder in a terminal window:
                </p>                
                <pre> 
                    npm run start
                </pre>
                <p>
                    which should once more result in a bunch of lines, ending this time with:
                </p>
                <pre> 
                    [HTTP SERVER] Server listening on http://127.0.0.1:8000
                </pre>                
                <p>
                    Open your favorite browser to the suggested url <code>http://127.0.0.1:8000</code> to the Nü splash-screen (left below). Clicking on said screen will lead you directly to the &ldquo;ready to play&rdquo; screen (right):
                </p>
            </div>

            <div class="col-lg-8 col-lg-offset-2 text-center">
                <img class="img-responsive" src="img/nu_splashscreen.png">                
            </div>    
            <div class="col-lg-12 text-justify">
                <p>
                    Finally, open the <code>./maxmsp/extra/nu.getting-started.maxpat</code> patcher to produce a few notes to test your installation. If your smartphone is connected to the same network as the computer running both server and max patch, connect it to the server <b> using its local IP address this time </b>. Mine at the moment is <code>192.168.0.12</code>, the resulting url: <code>http://192.168.0.12:8000</code>.
                </p>     
            </div>        
        </div>  


        <div class="row" id="start-design">
            <div class="col-lg-12 text-justify">
                <h1>Start designing</h1>
                <p>Every Nü module has its own Max abstraction, from which one controls both Client and Server parts of the module. As with standard Max objects, Nü objects (abstractions) can be combined to create complex scenarios without having to meddle in JavaScript. The best way to start designing your own Max patch is probably to read through the content of the <code>./maxmsp/help</code> folder, getting to know each module and its potential applications. The following video showcases some of these applications with the module available as of mid 2017:
                </p>
            </div>
            <div class="col-lg-10 col-lg-offset-1 text-center">
                <div class="embed-responsive embed-responsive-16by9">
                  <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/a4taMsypqos" allowfullscreen></iframe>
                </div>
            </div>    
            <div class="col-lg-12 text-justify">
                <p>
                    <b>Always have a main at hand</b>: Every Nü message in max is sent via an <code>udpsend</code> object to the Server. In Nü, this <code>udpsend</code> object is located in the <code>./maxmsp/patchers/nu.main.maxpat</code> abstraction. This means that you need an instance of the <code>nu.main.maxpat</code> abstraction present in your Max patch at all time if you want messages to reach the Server. Alternatively, you can have an instance of the <code>./maxmsp/extra/nu.monitor-b-patcher.maxpat</code> abstraction nested in a bpatch <i>(it instantiates both a <code>nu.main</code> and a <code>nu.output</code> abstraction, the later quite useful for debug sessions, see below) </i>.
                </p>                
                <p>
                    <b>Simulating devices on your laptop</b>: Hopefully, the <code>./maxmsp/extra/nu.monitor-b-patcher.maxpat</code> bpatcher coupled with the <code>./utils/openChromeArray.sh</code> utility will help you figure out how your design will feel like once deployed in a concert hall on numerous devices. The latter is a bash script that opens a NxN array of <a href="https://www.google.fr/chrome">Chrome</a> windows that will emulate Nü clients connected to your server. The former is a debug tool that can be used for real-time auralization of the clients audio outputs (binaural + room impulse response): position a virtual listener in the midst of the emulated clients to ear them as you would in the real thing (or close enough to assess whether your design is heading the right way).
                </p>
            </div>  

            <div class="col-lg-10 col-lg-offset-1 text-center">
                <h5>Development session layout. left: Max GUI, right: emulated Nü clients. An &ldquo;audio beam&rdquo; is projected in space (panned through the clients).<h5>
                <img class="img-responsive" style="margin-top:5px;" src="img/group_interface_v2.png">                
            </div>       
        </div> 

        <div class="row" id="deploy">
            <div class="col-lg-12 text-justify">
                <h1>Go full scale</h1>
                <p>
                    To deploy your newly designed web application and use it on the smartphones of (numerous, no doubt) spectators, you may need to modify the network configuration of the NodeJS server. Feel concerned by the following section only if you plan to use a WAN (as opposed to a LAN). Adapt the following parameters of the <code>./node/src/server/config/default.js</code> to the deployment network:
                </p>
            </div>

            <div class="col-sm-6 text-left">
                <h5 class="code-header">development (original):</h5>
                <pre> 
                    env: 'development' <br>
                    assetsDomain: '/' <br>
                    websockets: { <br>
                    ... <br>
                    path: '' <br>
                    } <br>
                </pre> 
            </div>
            <div class="col-sm-6 text-left">
                <h5 class="code-header">production (deployment):</h5>
                <pre> 
                    env: 'production' <br>
                    assetsDomain: 'http://my.domain.name.fr/myApp' <br>
                    websockets: { <br>
                    ... <br>
                    path: '/myApp/socket.io' <br>
                    } <br>
                </pre> 
            </div>

            <div class="col-lg-12 text-justify">
                <p>
                    If you intend to use Max on a different machine than the one running the NodeJS server, you'll also need to update the OSC field of the configuration file:
                </p>
            </div>

            <div class="col-sm-6 text-left">
                <h5 class="code-header">development (original):</h5>
                <pre> 
                  // configuration of the `osc` service <br>
                  osc: { <br>
                    ... <br>
                    receiveAddress: '127.0.0.1', <br>
                    sendAddress: '127.0.0.1', <br>
                  }
                </pre> 
            </div>
            <div class="col-sm-6 text-left">
                <h5 class="code-header">production (deployment):</h5>
                <pre> 
                  // configuration of the `osc` service <br>
                  osc: { <br>
                    ... <br>
                    receiveAddress: 'my.domain.name.fr', <br>
                    sendAddress: 'node.server.ip.address', <br>
                  }
                </pre> 
            </div>

            <div class="col-lg-12 text-justify">
                <p>
                    And if you're planning to use secure connections (HTTPS rather than HTTP, may be required for streaming GPS data and the like), you'll need to generate your own key and certificate and indicate their path in the <code>httpsInfos</code> field.
                </p>
            </div>

        </div>         

        <div class="row" id="create-module">
            <div class="col-lg-12 text-justify">
                <h1>Create new modules</h1>
                <p>
                    Creating a new module will require to (1) learn JavaScript and (2) understand the way the framework has been designed. The former I leave to you. For the later, have a look at both <code>nuTemplate</code> and <code>nuScore</code> modules. Keep in mind that each module has 3 components:

                    <ul>
                        <li>Server class: <code>./node/src/server/NuMyModuleName.js</code></li>
                        <li>Client class: <code>./node/src/client/player/NuMyModuleName.js</code></li>
                        <li>Max patch: <code>./maxmsp/patchers/nu.myModuleName.maxpat</code> </li>
                        <li><i>(optional) Max help patch: <code>./maxmsp/help/nu.myModuleName.maxhelp</code> </i></li>
                    </ul>                                    
                </p>
                <p>
                    From your readings, you should understand that:
                    <ul>
                        <li> All standard modules extend the <code>NuBaseModule</code> client/server Classes, responsible for the automatic routing of OSC messages to server and/or clients module methods and parameters, based on OSC headers.</li>
                        <li> If all players are concerned by an OSC message, it is stored in server's <code>this.param</code> attribute but if a method named after the OSC header is defined in the Server class of the module. <code>this.param</code> is broadcasted upon client connection to make sure every client shares a common state, even late comers.</li>
                        <li>Likewise, a Nü module on the Client side will save the values issued by its Server counterpart - values coming from OSC messages re-routed via web-socket by the server to concerned clients - to its <code>this.param</code> attribute but if it defines a method named after the OSC header.</li>
                    </ul>                
                </p>
            </div>
        </div> 

        <div class="row" id="faq">
            <div class="col-lg-12 text-justify">
                <h1>FAQ</h1>
                <p class="faq-q">
                    How do I add my own audio samples to the available sounds?
                </p>
                <p class="faq-a">
                    Add your audio files to any existing / new folder of the <code>./node/public/sounds</code> folder. The depth of the file tree does not matter as it's flattened at import. Restart the Nü server. Audio file names are referred to without their extension from Max, see e.g. <code>./maxmsp/extra/nu.getting-started.maxpat</code>. Prefer .mp3 or .wav for you files extensions.
                </p>
            </div>
        </div>         

        <div class="row" id="about">
            <div class="col-lg-12 text-justify">
                <h1>About</h1>
                <p>
                    <b>License</b>:The Nü framework is released under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD 3-Clause license</a>.
                </p>

                <p>
                    <b>Credits</b>: Nü has been developed at <a href="https://www.ircam.fr/">IRCAM-CNRS</a> within the <a href="http://cosima.ircam.fr/">CoSiMa</a> research project, supported by the French National Research Agency (ANR).
                </p>
            </div>
            <div class="col-lg-12 text-center">
                <p> </p>
                <p>
                    <a href="mailto:david.poirier-quinot@ircam.fr"><i class="fa fa-envelope-o fa-3x"></i></a>
                </p>
            </div>
        </div> 

    </div> <!-- /.container -->
    

    <!-- jQuery Version 1.11.1 -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
